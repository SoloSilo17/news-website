<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Portal de noticias en español con las últimas actualizaciones nacionales e internacionales">
    <meta name="keywords" content="noticias, deportes, cultura, internacional">
    <meta name="author" content="Noticias en Español">
    <title>Noticias en Español</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    
</head>
<body>
    <header>
        <h1>Noticias en Español</h1>
        <p>El portal para las últimas noticias del mundo hispanohablante.</p>
    </header>

    <nav>
        <a href="#inicio" id="inicio-link">Inicio</a>
        <a href="#nacional" id="nacional-link">Nacional</a>
        <a href="#internacional" id="internacional-link">Internacional</a>
        <a href="#deportes" id="deportes-link">Deportes</a>
        <a href="#immigracion" id="immigracion-link">Immigracion</a>
    </nav>

    <main>
        <section id="inicio" class="section">
            <h2>Inicio</h2>
            <div id="inicio-articles"></div>
        </section>

        <section id="nacional" class="section" style="display: none;">
            <h2>Nacional</h2>
            <div id="nacional-articles"></div>
        </section>

        <section id="internacional" class="section" style="display: none;">
            <h2>Internacional</h2>
            <div id="internacional-articles"></div>
        </section>

        <section id="deportes" class="section" style="display: none;">
            <h2>Deportes</h2>
            <div id="deportes-articles"></div>
        </section>

        <section id="cultura" class="section" style="display: none;">
            <h2>Cultura</h2>
            <div id="cultura-articles"></div>
        </section>

        <section id="full-article-view" class="full-article"></section>
    </main>

    <footer>
        <p>&copy; 2025 Noticias en Español. Todos los derechos reservados.</p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const sections = document.querySelectorAll(".section");
            const links = document.querySelectorAll("nav a");
            const fullArticleView = document.getElementById("full-article-view");

            // Function to show the selected section
            const showSection = (sectionId) => {
                sections.forEach((section) => {
                    if (section.id === sectionId) {
                        section.style.display = "block";
                    } else {
                        section.style.display = "none";
                        const container = section.querySelector("div");
                        if (container) {
                            container.innerHTML = ""; // Clear content of non-active sections
                        }
                    }
                });
                fullArticleView.classList.remove("active");
            };

            // Attach click event listeners to navigation links
            links.forEach((link) => {
                link.addEventListener("click", (e) => {
                    e.preventDefault();
                    const targetSection = e.target.getAttribute("href").replace("#", "");
                    showSection(targetSection);

                    // Fetch articles for the selected section if not "Inicio"
                    if (targetSection !== "inicio") {
                        fetchArticlesByCategory(targetSection, `${targetSection}-articles`);
                    }
                });
            });

            // Load "Inicio" by default
            showSection("inicio");

            // Function to fetch articles by category
            const fetchArticlesByCategory = async (category, containerId) => {
                try {
                    const response = await fetch(`/api/articles/${category}`);
                    if (!response.ok) {
                        throw new Error(`HTTP error! Status: ${response.status}`);
                    }

                    const articles = await response.json();
                    const container = document.getElementById(containerId);
                    container.innerHTML = ""; // Clear existing content before displaying new articles

                    articles.forEach((article) => {
                        const articleElement = document.createElement("article");
                        articleElement.classList.add("article");
                        articleElement.innerHTML = `
                            <div class="article-content">
                                <h3>${article.title}</h3>
                                <p><strong>Resumen:</strong> ${article.summary}</p>
                                <p><strong>Categoría:</strong> ${article.category}</p>
                                <p><em>Publicado el: ${new Date(article.publish_date).toLocaleDateString()}</em></p>
                                <p>${article.content}</p>
                            </div>
                            <img src="${article.image_url}" alt="${article.title}" class="article-image">
                        `;

                        articleElement.addEventListener("click", () => {
                            viewFullArticle(article);
                        });

                        container.appendChild(articleElement);
                    });
                } catch (error) {
                    console.error("Error fetching articles:", error);
                }
            };

            const viewFullArticle = (article) => {
                fullArticleView.innerHTML = `
                    <a href="#inicio" class="back-button">&larr; Volver</a>
                    <h2>${article.title}</h2>
                    <img src="${article.image_url}" alt="${article.title}" style="max-width: 100%; height: auto; margin-bottom: 20px;">
                    <p><strong>Resumen:</strong> ${article.summary}</p>
                    <p><strong>Categoría:</strong> ${article.category}</p>
                    <p><em>Publicado el: ${new Date(article.publish_date).toLocaleDateString()}</em></p>
                    <p>${article.content}</p>
                `;
                fullArticleView.classList.add("active");
                sections.forEach((section) => section.style.display = "none");
            };
        });
    </script>

    <script src="app.js"></script>

</body>
</html>
